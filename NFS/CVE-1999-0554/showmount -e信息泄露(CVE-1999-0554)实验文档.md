# 目标主机showmount -e信息泄露(CVE-1999-0554)
## 1.实验介绍
此实验可以对目标主机进行“showmount -e”操作，此操作将泄露目标主机大量敏感信息，比如目录结构。更糟糕的是，如果访问控制不严的话，攻击者有可能直接访问到目标主机上的数据。
## 2.实验原理
“showmout -e”检查的是rpc.mountd 这个NFS的守护进程，rpc.mountd可以访问文件系统，当客户端顺利地通过rpc.nfsd登录NFS服务器后，在使用NFS服务器所提供的文件前，还必须通过文件使用权限的验证，rpc.mountd会读取NFS的配置文件/etc/exports来对比客户端的权限。通过“showmount -e”这个过程展示nfs的挂载列表。
## 3.实验准备
实验环境如下：
安装了NFS**服务端**的centos7.8服务器：**192.168.32.11**
安装了NFS**客户端**的centos7.8服务器：**192.168.32.12**

## 4.实验步骤
### 1）服务端安装
使用 yum 安装 NFS 安装包。
yum install nfs-utils
![](I:\work\截图\目标主机showmount -e信息泄露(CVE-1999-0554)\server安装nfs.jpg)

### 2）服务端配置
设置 NFS 服务开机启动
systemctl enable rpcbind
systemctl enable nfs
![](I:\work\截图\目标主机showmount -e信息泄露(CVE-1999-0554)\server配置.jpg)
启动 NFS 服务
systemctl start rpcbind
systemctl start nfs
![](I:\work\截图\目标主机showmount -e信息泄露(CVE-1999-0554)\server启动nfs.jpg)
防火墙需要打开 rpc-bind 和 nfs 的服务
systemctl start firewalld
firewall-cmd --zone=public --permanent --add-service={rpc-bind,mountd,nfs}
firewall-cmd --reload
![](I:\work\截图\目标主机showmount -e信息泄露(CVE-1999-0554)\防火墙打开nfs服务.jpg)

### 3）配置共享目录
服务启动之后，我们在服务端配置一个共享目录
mkdir /data
chmod 755 /data

根据这个目录，相应配置导出目录
vi /etc/exports

添加如下配置
/data 192.168.32.0/24(rw,sync,no_root_squash,no_all_squash)
/data: 共享目录位置。
192.168.32.0/24: 客户端 IP 范围，* 代表所有，即没有限制。
rw: 权限设置，可读可写。
sync: 同步共享目录。
no_root_squash: 可以使用 root 授权。
no_all_squash: 可以使用普通用户授权。

:wq 保存设置之后，重启 NFS 服务。
systemctl restart nfs

可以检查一下本地的共享目录
showmount -e localhost
这样，服务端就配置好了，接下来配置客户端，连接服务端，使用共享目录。
![](I:\work\截图\目标主机showmount -e信息泄露(CVE-1999-0554)\server配置共享目录.jpg)

### 4）客户端安装及配置
安装与服务端类似：
yum install nfs-utils
配置：
systemctl enable rpcbind
systemctl start rpcbind
![](I:\work\截图\目标主机showmount -e信息泄露(CVE-1999-0554)\client安装配置.jpg)

### 5）客户端查询服务端的共享目录
showmount -e 192.168.32.11(服务端ip)
![](I:\work\截图\目标主机showmount -e信息泄露(CVE-1999-0554)\client查询共享目录.jpg)